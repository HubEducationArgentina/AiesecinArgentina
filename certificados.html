<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Bienvenido - Plataforma Educativa</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>


<!-- HEADER: logo - progress module - nav -->
<header>
  <div class="logo">VALKIRIANS | HUB EDUCACIONAL</div>

  <!-- Módulo de progreso -->
  <div class="progress-module" id="progressModule" aria-label="Progreso del usuario">
    <div class="level" id="levelLabel">NIVEL 3</div>

    <div class="progress-wrapper" title="Progreso">
      <div class="progress-track" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" id="progressTrack">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-info">
        <span id="xpLabel">Experiencia Obtenida</span>
      </div>
    </div>
  </div>

  <nav>
    <a href="home.html">Inicio</a>
    <a href="certificados.html">Certificados</a>
    <a href="miscursos.html">Mis cursos</a>
    <a href="index.html" id="logout">Cerrar sesión</a>
  </nav>
</header>


<script>
// Script para leer la información del progress.json

fetch('progress.json')
  .then(response => response.json())
  .then(data => {
    const currentUser = localStorage.getItem('username');
    const userData = data.find(user => user.username === currentUser);
    if (userData) {
      // Actualiza la barra de progreso con los datos del usuario
      updateProgress(userData);
    }
  });
</script>

<script>
// Script para actualizar la barra de información del progress.json

function updateProgress(userData) {
  const progressFill = document.getElementById('progressFill');
  const progressTrack = document.getElementById('progressTrack');
  const xpLabel = document.getElementById('xpLabel');
  const levelLabel = document.getElementById('levelLabel');

  const totalXP = 1000; // El total de experiencia que se necesita para llegar al nivel máximo
  const currentXP = userData.currentXP; // La experiencia actual del usuario
  const level = userData.level; // El nivel actual del usuario

  const pct = Math.round((currentXP / totalXP) * 100);
  progressFill.style.width = pct + '%';
  progressTrack.setAttribute('aria-valuenow', pct);

  xpLabel.textContent = `${currentXP} / ${totalXP} XP`;
  levelLabel.textContent = `NIVEL ${level}`;
}
</script>


<script>
/*
  Uso:
    - Inicializa con initProgress({currentXP, totalXP, level, username})
    - Para sumar XP: addXP(amount)
    - Persiste por usuario en localStorage bajo clave 'progress_{username}'
*/

// Helper: capitalizar (opcional)
function capitalize(s){ return s ? s.charAt(0).toUpperCase()+s.slice(1) : ''; }

// Leer username guardado (si lo guardas en login)
const currentUser = localStorage.getItem('username') || 'guest';

// IDs de elementos
const progressFill = document.getElementById('progressFill');
const progressTrack = document.getElementById('progressTrack');
const xpLabel = document.getElementById('xpLabel');
const levelLabel = document.getElementById('levelLabel');

const storageKey = `progress_${currentUser}`;

// carga inicial desde localStorage si existe, sino valores default (ajusta)
const defaultState = { level: 3, currentXP: 1300, totalXP: 3699 };
let state = loadState() || defaultState;
renderProgress();

/* --- Funciones públicas --- */
function initProgress({ currentXP=0, totalXP=100, level=1 } = {}) {
  state = { level, currentXP, totalXP };
  saveState();
  renderProgress();
}

// Sumar XP (ej: cuando completa una actividad)
function addXP(amount) {
  state.currentXP += amount;
  // si pasa el total, subir nivel y recalcular (ejemplo simple)
  while (state.currentXP >= state.totalXP) {
    state.currentXP -= state.totalXP;
    state.level += 1;
    // ejemplo: totalXP aumenta un 20% cada nivel (ajusta fórmula a tu sistema)
    state.totalXP = Math.round(state.totalXP * 1.2);
  }
  saveState();
  renderProgress();
}

/* --- Internas --- */
function renderProgress() {
  const pct = Math.round((state.currentXP / state.totalXP) * 100);
  const bounded = Math.max(0, Math.min(100, pct));
  progressFill.style.width = bounded + '%';
  progressTrack.setAttribute('aria-valuenow', bounded);

  xpLabel.textContent = `${state.currentXP} / ${state.totalXP} XP`;
  levelLabel.textContent = `NIVEL ${state.level}`;

  // tooltip accesible (title)
  progressTrack.parentElement.title = 'Experiencia obtenida';
}

// Persistir en localStorage
function saveState() {
  try {
    localStorage.setItem(storageKey, JSON.stringify(state));
  } catch(e) {
    console.warn('No se pudo guardar progreso en localStorage:', e);
  }
}
function loadState() {
  try {
    const raw = localStorage.getItem(storageKey);
    return raw ? JSON.parse(raw) : null;
  } catch(e) {
    return null;
  }
}

/* --- Opcional: exponer en window para pruebas desde consola --- */
window.progressModule = {
  initProgress,
  addXP,
  getState: () => JSON.parse(JSON.stringify(state)),
};

// Ejemplo: cuando el usuario está en la página y completa una actividad,
// puedes llamar desde tu lógica: progressModule.addXP(120);
</script>

    

<main class="welcome-container">
    <p>
        Aún no tienes ningún certificado.
    </p>

</main>







<footer class="footer-fixed">
    Hub Educacional — Argentina 2025
</footer>

<script>
    // Mostrar el nombre del usuario si fue guardado en login
    const user = localStorage.getItem('username');
    if (user) {
        document.getElementById('username').textContent = user.toUpperCase();
    }
</script>


<script>
  (function() {
    console.log('home.html: verificación de sesión iniciada.');
    const username = localStorage.getItem('username');
    console.log('Valor de localStorage.username =', username);

    // Si no existe, redirigimos (o mostramos mensaje). Aquí redirigimos al login.
    if (!username) {
      console.warn('No hay usuario en localStorage. Redirigiendo a index.html');
      // Si prefieres mostrar mensaje en vez de redirigir, comenta la siguiente línea.
      location.href = 'index.html';
      return;
    }

    // Mostrar el usuario con capitalizar la primera letra:
    function capitalize(name) {
      if (!name) return '';
      return name.charAt(0).toUpperCase() + name.slice(1);
    }

    const displayName = capitalize(username);
    const el = document.getElementById('username');
    if (el) {
      el.textContent = displayName;
      console.log('Nombre mostrado en pantalla:', displayName);
    } else {
      console.error('home.html: no se encontró elemento #username en el DOM.');
    }

    // Logout: si el enlace tiene id 'logout', activamos el comportamiento
    const logoutEl = document.getElementById('logout');
    if (logoutEl) {
      logoutEl.addEventListener('click', (e) => {
        e.preventDefault();
        localStorage.removeItem('username');
        console.log('Usuario deslogueado, redirigiendo a index.html');
        location.href = 'index.html';
      });
    }
  })();
</script>






</body>
</html>
